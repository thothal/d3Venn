!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).venn={})}(this,function(t){"use strict";const e=1e-10;function n(t,n){const i=function(t){const e=[];for(let n=0;n<t.length;++n)for(let s=n+1;s<t.length;++s){const r=o(t[n],t[s]);for(const t of r)t.parentIndex=[n,s],e.push(t)}return e}(t),l=i.filter(n=>(function(t,n){return n.every(n=>r(t,n)<n.radius+e)})(n,t));let c=0,u=0;const f=[];if(l.length>1){const e=a(l);for(let t=0;t<l.length;++t){const n=l[t];n.angle=Math.atan2(n.x-e.x,n.y-e.y)}l.sort((t,e)=>e.angle-t.angle);let n=l[l.length-1];for(let e=0;e<l.length;++e){const i=l[e];u+=(n.x+i.x)*(i.y-n.y);const o={x:(i.x+n.x)/2,y:(i.y+n.y)/2};let a=null;for(let e=0;e<i.parentIndex.length;++e)if(n.parentIndex.includes(i.parentIndex[e])){const s=t[i.parentIndex[e]],l=Math.atan2(i.x-s.x,i.y-s.y),c=Math.atan2(n.x-s.x,n.y-s.y);let u=c-l;u<0&&(u+=2*Math.PI);const f=c-u/2;let h=r(o,{x:s.x+s.radius*Math.sin(f),y:s.y+s.radius*Math.cos(f)});h>2*s.radius&&(h=2*s.radius),(null==a||a.width>h)&&(a={circle:s,width:h,p1:i,p2:n,large:h>s.radius,sweep:!0})}null!=a&&(f.push(a),c+=s(a.circle.radius,a.width),n=i)}}else{let n=t[0];for(let e=1;e<t.length;++e)t[e].radius<n.radius&&(n=t[e]);let s=!1;for(let e=0;e<t.length;++e)if(r(t[e],n)>Math.abs(n.radius-t[e].radius)){s=!0;break}s?c=u=0:(c=n.radius*n.radius*Math.PI,f.push({circle:n,p1:{x:n.x,y:n.y+n.radius},p2:{x:n.x-e,y:n.y+n.radius},width:2*n.radius,large:!0,sweep:!0}))}return u/=2,n&&(n.area=c+u,n.arcArea=c,n.polygonArea=u,n.arcs=f,n.innerPoints=l,n.intersectionPoints=i),c+u}function s(t,e){return t*t*Math.acos(1-e/t)-(t-e)*Math.sqrt(e*(2*t-e))}function r(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))}function i(t,e,n){if(n>=t+e)return 0;if(n<=Math.abs(t-e))return Math.PI*Math.min(t,e)*Math.min(t,e);const r=e-(n*n-t*t+e*e)/(2*n);return s(t,t-(n*n-e*e+t*t)/(2*n))+s(e,r)}function o(t,e){const n=r(t,e),s=t.radius,i=e.radius;if(n>=s+i||n<=Math.abs(s-i))return[];const o=(s*s-i*i+n*n)/(2*n),a=Math.sqrt(s*s-o*o),l=t.x+o*(e.x-t.x)/n,c=t.y+o*(e.y-t.y)/n,u=-(e.y-t.y)*(a/n),f=-(e.x-t.x)*(a/n);return[{x:l+u,y:c-f},{x:l-u,y:c+f}]}function a(t){const e={x:0,y:0};for(const n of t)e.x+=n.x,e.y+=n.y;return e.x/=t.length,e.y/=t.length,e}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var l,c,u=(function(t,e){!function(t){function e(t){for(var e=new Array(t),n=0;n<t;++n)e[n]=0;return e}function n(t,e){for(var n=0,s=0;s<t.length;++s)n+=t[s]*e[s];return n}function s(t){return Math.sqrt(n(t,t))}function r(t,e,n){for(var s=0;s<e.length;++s)t[s]=e[s]*n}function i(t,e,n,s,r){for(var i=0;i<t.length;++i)t[i]=e*n[i]+s*r[i]}function o(t,e,s,r,o,a,l){var c=s.fx,u=n(s.fxprime,e),f=c,h=c,x=u,g=0;function d(h,g,d){for(var p=0;p<16;++p)if(o=(h+g)/2,i(r.x,1,s.x,o,e),f=r.fx=t(r.x,r.fxprime),x=n(r.fxprime,e),f>c+a*o*u||f>=d)g=o;else{if(Math.abs(x)<=-l*u)return o;x*(g-h)>=0&&(g=h),h=o,d=f}return 0}o=o||1,a=a||1e-6,l=l||.1;for(var p=0;p<10;++p){if(i(r.x,1,s.x,o,e),f=r.fx=t(r.x,r.fxprime),x=n(r.fxprime,e),f>c+a*o*u||p&&f>=h)return d(g,o,h);if(Math.abs(x)<=-l*u)return o;if(x>=0)return d(o,g,f);h=f,g=o,o*=2}return o}t.bisect=function(t,e,n,s){var r=(s=s||{}).maxIterations||100,i=s.tolerance||1e-10,o=t(e),a=t(n),l=n-e;if(o*a>0)throw"Initial bisect points must have opposite signs";if(0===o)return e;if(0===a)return n;for(var c=0;c<r;++c){var u=e+(l/=2),f=t(u);if(f*o>=0&&(e=u),Math.abs(l)<i||0===f)return u}return e+l},t.nelderMead=function(t,e,n){var s,r=(n=n||{}).maxIterations||200*e.length,o=n.nonZeroDelta||1.05,a=n.zeroDelta||.001,l=n.minErrorDelta||1e-6,c=n.minErrorDelta||1e-5,u=void 0!==n.rho?n.rho:1,f=void 0!==n.chi?n.chi:2,h=void 0!==n.psi?n.psi:-.5,x=void 0!==n.sigma?n.sigma:.5,g=e.length,d=new Array(g+1);d[0]=e,d[0].fx=t(e),d[0].id=0;for(var p=0;p<g;++p){var y=e.slice();y[p]=y[p]?y[p]*o:a,d[p+1]=y,d[p+1].fx=t(y),d[p+1].id=p+1}function m(t){for(var e=0;e<t.length;e++)d[g][e]=t[e];d[g].fx=t.fx}for(var M=function(t,e){return t.fx-e.fx},v=e.slice(),b=e.slice(),z=e.slice(),w=e.slice(),I=0;I<r;++I){if(d.sort(M),n.history){var R=d.map(function(t){var e=t.slice();return e.fx=t.fx,e.id=t.id,e});R.sort(function(t,e){return t.id-e.id}),n.history.push({x:d[0].slice(),fx:d[0].fx,simplex:R})}for(s=0,p=0;p<g;++p)s=Math.max(s,Math.abs(d[0][p]-d[1][p]));if(Math.abs(d[0].fx-d[g].fx)<l&&s<c)break;for(p=0;p<g;++p){v[p]=0;for(var A=0;A<g;++A)v[p]+=d[A][p];v[p]/=g}var F=d[g];if(i(b,1+u,v,-u,F),b.fx=t(b),b.fx<d[0].fx)i(w,1+f,v,-f,F),w.fx=t(w),w.fx<b.fx?m(w):m(b);else if(b.fx>=d[g-1].fx){var P=!1;if(b.fx>F.fx?(i(z,1+h,v,-h,F),z.fx=t(z),z.fx<F.fx?m(z):P=!0):(i(z,1-h*u,v,h*u,F),z.fx=t(z),z.fx<b.fx?m(z):P=!0),P){if(x>=1)break;for(p=1;p<d.length;++p)i(d[p],1-x,d[0],x,d[p]),d[p].fx=t(d[p])}}else m(b)}return d.sort(M),{fx:d[0].fx,x:d[0]}},t.conjugateGradient=function(t,e,a){var l,c,u,f={x:e.slice(),fx:0,fxprime:e.slice()},h={x:e.slice(),fx:0,fxprime:e.slice()},x=e.slice(),g=1;u=(a=a||{}).maxIterations||20*e.length,f.fx=t(f.x,f.fxprime),r(l=f.fxprime.slice(),f.fxprime,-1);for(var d=0;d<u;++d){if(g=o(t,l,f,h,g),a.history&&a.history.push({x:f.x.slice(),fx:f.fx,fxprime:f.fxprime.slice(),alpha:g}),g){i(x,1,h.fxprime,-1,f.fxprime);var p=n(f.fxprime,f.fxprime),y=Math.max(0,n(x,h.fxprime)/p);i(l,y,l,-1,h.fxprime),c=f,f=h,h=c}else r(l,f.fxprime,-1);if(s(f.fxprime)<=1e-5)break}return a.history&&a.history.push({x:f.x.slice(),fx:f.fx,fxprime:f.fxprime.slice(),alpha:g}),f},t.gradientDescent=function(t,e,n){for(var r=(n=n||{}).maxIterations||100*e.length,o=n.learnRate||.001,a={x:e.slice(),fx:0,fxprime:e.slice()},l=0;l<r&&(a.fx=t(a.x,a.fxprime),n.history&&n.history.push({x:a.x.slice(),fx:a.fx,fxprime:a.fxprime.slice()}),i(a.x,1,a.x,-o,a.fxprime),!(s(a.fxprime)<=1e-5));++l);return a},t.gradientDescentLineSearch=function(t,e,n){n=n||{};var i,a={x:e.slice(),fx:0,fxprime:e.slice()},l={x:e.slice(),fx:0,fxprime:e.slice()},c=n.maxIterations||100*e.length,u=n.learnRate||1,f=e.slice(),h=n.c1||.001,x=n.c2||.1,g=[];if(n.history){var d=t;t=function(t,e){return g.push(t.slice()),d(t,e)}}a.fx=t(a.x,a.fxprime);for(var p=0;p<c&&(r(f,a.fxprime,-1),u=o(t,f,a,l,u,h,x),n.history&&(n.history.push({x:a.x.slice(),fx:a.fx,fxprime:a.fxprime.slice(),functionCalls:g,learnRate:u,alpha:u}),g=[]),i=a,a=l,l=i,!(0===u||s(a.fxprime)<1e-5));++p);return a},t.zeros=e,t.zerosM=function(t,n){return e(t).map(function(){return e(n)})},t.norm2=s,t.weightedSum=i,t.scale=r}(e)}(c={path:l,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==e&&c.path)}},c.exports),c.exports);function f(t,e={}){e.maxIterations=e.maxIterations||500;const n=e.initialLayout||g,s=e.lossFunction||p,r=function(t,e={}){const n=e.distinct,s=t.map(t=>Object.assign({},t));function r(t){return t.join(";")}if(n){const t=new Map;for(const e of s)for(let n=0;n<e.sets.length;n++){const s=String(e.sets[n]);t.set(s,e.size+(t.get(s)||0));for(let r=n+1;r<e.sets.length;r++){const n=String(e.sets[r]),i=`${s};${n}`,o=`${n};${s}`;t.set(i,e.size+(t.get(i)||0)),t.set(o,e.size+(t.get(o)||0))}}for(const e of s)e.sets.length<3&&(e.size=t.get(r(e.sets)))}const i=[],o=new Set;for(const t of s)if(1===t.sets.length)i.push(t.sets[0]);else if(2===t.sets.length){const e=t.sets[0],n=t.sets[1];o.add(r(t.sets)),o.add(r([n,e]))}i.sort((t,e)=>t===e?0:t<e?-1:1);for(let t=0;t<i.length;++t){const e=i[t];for(let n=t+1;n<i.length;++n){const t=i[n];o.has(r([e,t]))||s.push({sets:[e,t],size:0})}}return s}(t,e),i=n(r,e),o=Object.keys(i),a=[];for(const t of o)a.push(i[t].x),a.push(i[t].y);const l=u.nelderMead(t=>{const e={};for(let n=0;n<o.length;++n){const s=o[n];e[s]={x:t[2*n],y:t[2*n+1],radius:i[s].radius}}return s(e,r)},a,e).x;for(let t=0;t<o.length;++t){const e=o[t];i[e].x=l[2*t],i[e].y=l[2*t+1]}return i}const h=1e-10;function x(t,e,n){return Math.min(t,e)*Math.min(t,e)*Math.PI<=n+h?Math.abs(t-e):u.bisect(s=>i(t,e,s)-n,0,t+e)}function g(t,e={}){let n=d(t,e);const s=e.lossFunction||p;if(t.length>=8){const r=function(t,e={}){const n=e.restarts||10,s=[],r={};for(const e of t)1===e.sets.length&&(r[e.sets[0]]=s.length,s.push(e));let{distances:i,constraints:o}=function(t,e,n){const s=u.zerosM(e.length,e.length),r=u.zerosM(e.length,e.length);return t.filter(t=>2===t.sets.length).forEach(t=>{const i=n[t.sets[0]],o=n[t.sets[1]],a=x(Math.sqrt(e[i].size/Math.PI),Math.sqrt(e[o].size/Math.PI),t.size);s[i][o]=s[o][i]=a;let l=0;t.size+1e-10>=Math.min(e[i].size,e[o].size)?l=1:t.size<=1e-10&&(l=-1),r[i][o]=r[o][i]=l}),{distances:s,constraints:r}}(t,s,r);const a=u.norm2(i.map(u.norm2))/i.length;i=i.map(t=>t.map(t=>t/a));const l=(t,e)=>(function(t,e,n,s){for(let t=0;t<e.length;++t)e[t]=0;let r=0;for(let i=0;i<n.length;++i){const o=t[2*i],a=t[2*i+1];for(let l=i+1;l<n.length;++l){const c=t[2*l],u=t[2*l+1],f=n[i][l],h=s[i][l],x=(c-o)*(c-o)+(u-a)*(u-a),g=Math.sqrt(x),d=x-f*f;h>0&&g<=f||h<0&&g>=f||(r+=2*d*d,e[2*i]+=4*d*(o-c),e[2*i+1]+=4*d*(a-u),e[2*l]+=4*d*(c-o),e[2*l+1]+=4*d*(u-a))}}return r})(t,e,i,o);let c=null;for(let t=0;t<n;++t){const t=u.zeros(2*i.length).map(Math.random),n=u.conjugateGradient(l,t,e);(!c||n.fx<c.fx)&&(c=n)}const f=c.x,h={};for(let t=0;t<s.length;++t){const e=s[t];h[e.sets[0]]={x:f[2*t]*a,y:f[2*t+1]*a,radius:Math.sqrt(e.size/Math.PI)}}if(e.history)for(const t of e.history)u.scale(t.x,a);return h}(t,e);s(r,t)+1e-8<s(n,t)&&(n=r)}return n}function d(t,e){const n=e&&e.lossFunction?e.lossFunction:p,s={},r={};for(const e of t)if(1===e.sets.length){const t=e.sets[0];s[t]={x:1e10,y:1e10,rowid:s.length,size:e.size,radius:Math.sqrt(e.size/Math.PI)},r[t]=[]}t=t.filter(t=>2===t.sets.length);for(const e of t){let t=null!=e.weight?e.weight:1;const n=e.sets[0],i=e.sets[1];e.size+h>=Math.min(s[n].size,s[i].size)&&(t=0),r[n].push({set:i,size:e.size,weight:t}),r[i].push({set:n,size:e.size,weight:t})}const i=[];function a(t,e){return e.size-t.size}Object.keys(r).forEach(t=>{let e=0;for(let n=0;n<r[t].length;++n)e+=r[t][n].size*r[t][n].weight;i.push({set:t,size:e})}),i.sort(a);const l={};function c(t){return t.set in l}function u(t,e){s[e].x=t.x,s[e].y=t.y,l[e]=!0}u({x:0,y:0},i[0].set);for(let e=1;e<i.length;++e){const l=i[e].set,h=r[l].filter(c),g=s[l];if(h.sort(a),0===h.length)throw"ERROR: missing pairwise overlap information";const d=[];for(var f=0;f<h.length;++f){const t=s[h[f].set],e=x(g.radius,t.radius,h[f].size);d.push({x:t.x+e,y:t.y}),d.push({x:t.x-e,y:t.y}),d.push({y:t.y+e,x:t.x}),d.push({y:t.y-e,x:t.x});for(let n=f+1;n<h.length;++n){const r=s[h[n].set],i=x(g.radius,r.radius,h[n].size),a=o({x:t.x,y:t.y,radius:e},{x:r.x,y:r.y,radius:i});d.push(...a)}}let p=1e50,y=d[0];for(const e of d){s[l].x=e.x,s[l].y=e.y;const r=n(s,t);r<p&&(p=r,y=e)}u(y,l)}return s}function p(t,e){let s=0;for(const o of e){if(1===o.sets.length)continue;let e;if(2===o.sets.length){const n=t[o.sets[0]],s=t[o.sets[1]];e=i(n.radius,s.radius,r(n,s))}else e=n(o.sets.map(e=>t[e]));s+=(null!=o.weight?o.weight:1)*(e-o.size)*(e-o.size)}return s}function y(t,e){let s=0;for(const o of e){if(1===o.sets.length)continue;let e;if(2===o.sets.length){const n=t[o.sets[0]],s=t[o.sets[1]];e=i(n.radius,s.radius,r(n,s))}else e=n(o.sets.map(e=>t[e]));const a=null!=o.weight?o.weight:1,l=Math.log((e+1)/(o.size+1));s+=a*l*l}return s}function m(t,e,n){if(null==n?t.sort((t,e)=>e.radius-t.radius):t.sort(n),t.length>0){const e=t[0].x,n=t[0].y;for(const s of t)s.x-=e,s.y-=n}if(2===t.length){r(t[0],t[1])<Math.abs(t[1].radius-t[0].radius)&&(t[1].x=t[0].x+t[0].radius-t[1].radius-1e-10,t[1].y=t[0].y)}if(t.length>1){const n=Math.atan2(t[1].x,t[1].y)-e,s=Math.cos(n),r=Math.sin(n);for(const e of t){const t=e.x,n=e.y;e.x=s*t-r*n,e.y=r*t+s*n}}if(t.length>2){let n=Math.atan2(t[2].x,t[2].y)-e;for(;n<0;)n+=2*Math.PI;for(;n>2*Math.PI;)n-=2*Math.PI;if(n>Math.PI){const e=t[1].y/(1e-10+t[1].x);for(const n of t){var s=(n.x+e*n.y)/(1+e*e);n.x=2*s-n.x,n.y=2*s*e-n.y}}}}function M(t){function e(t){return t.parent!==t&&(t.parent=e(t.parent)),t.parent}function n(t,n){const s=e(t),r=e(n);s.parent=r}t.forEach(t=>{t.parent=t});for(let e=0;e<t.length;++e)for(let s=e+1;s<t.length;++s){const i=t[e].radius+t[s].radius;r(t[e],t[s])+1e-10<i&&n(t[s],t[e])}const s=new Map;for(let n=0;n<t.length;++n){const r=e(t[n]).parent.setid;s.has(r)||s.set(r,[]),s.get(r).push(t[n])}return t.forEach(t=>{delete t.parent}),Array.from(s.values())}function v(t){const e=e=>{return{max:t.reduce((t,n)=>Math.max(t,n[e]+n.radius),Number.NEGATIVE_INFINITY),min:t.reduce((t,n)=>Math.min(t,n[e]-n.radius),Number.POSITIVE_INFINITY)}};return{xRange:e("x"),yRange:e("y")}}function b(t,e,n){null==e&&(e=Math.PI/2);let s=I(t).map(t=>Object.assign({},t));const r=M(s);for(const t of r){m(t,e,n);const s=v(t);t.size=(s.xRange.max-s.xRange.min)*(s.yRange.max-s.yRange.min),t.bounds=s}r.sort((t,e)=>e.size-t.size);let i=(s=r[0]).bounds;const o=(i.xRange.max-i.xRange.min)/50;function a(t,e,n){if(!t)return;const r=t.bounds;let a,l;if(e)a=i.xRange.max-r.xRange.min+o;else{a=i.xRange.max-r.xRange.max;const t=(r.xRange.max-r.xRange.min)/2-(i.xRange.max-i.xRange.min)/2;t<0&&(a+=t)}if(n)l=i.yRange.max-r.yRange.min+o;else{l=i.yRange.max-r.yRange.max;const t=(r.yRange.max-r.yRange.min)/2-(i.yRange.max-i.yRange.min)/2;t<0&&(l+=t)}for(const e of t)e.x+=a,e.y+=l,s.push(e)}let l=1;for(;l<r.length;)a(r[l],!0,!1),a(r[l+1],!1,!0),a(r[l+2],!0,!0),l+=3,i=v(s);return w(s)}function z(t,e,n,s,r){const i=I(t);e-=2*s,n-=2*s;const{xRange:o,yRange:a}=v(i);if(o.max===o.min||a.max===a.min)return console.log("not scaling solution: zero size detected"),t;let l,c;if(r){const t=2*Math.sqrt(r/Math.PI);l=e/t,c=n/t}else l=e/(o.max-o.min),c=n/(a.max-a.min);const u=Math.min(c,l),f=(e-(o.max-o.min)*u)/2,h=(n-(a.max-a.min)*u)/2;return w(i.map(t=>({radius:u*t.radius,x:s+f+(t.x-o.min)*u,y:s+h+(t.y-a.min)*u,setid:t.setid})))}function w(t){const e={};for(const n of t)e[n.setid]=n;return e}function I(t){return Object.keys(t).map(e=>Object.assign(t[e],{setid:e}))}function R(t,e){return function(n){const s=this,r=t[n.sets[0]].radius||50,i=e(n)||"",o=i.split(/\s+/).reverse(),a=(i.length+o.length)/3;let l=o.pop(),c=[l],u=0;s.textContent=null;const f=[];function h(t){const e=s.ownerDocument.createElementNS(s.namespaceURI,"tspan");return e.textContent=t,f.push(e),s.append(e),e}let x=h(l);for(;l=o.pop();){c.push(l);const t=c.join(" ");x.textContent=t,t.length>a&&x.getComputedTextLength()>r&&(c.pop(),x.textContent=c.join(" "),c=[l],x=h(l),u++)}const g=.35-1.1*u/2,d=s.getAttribute("x"),p=s.getAttribute("y");f.forEach((t,e)=>{t.setAttribute("x",d),t.setAttribute("y",p),t.setAttribute("dy",`${g+1.1*e}em`)})}}function A(t,e,n){let s=e[0].radius-r(e[0],t);for(let n=1;n<e.length;++n){const i=e[n].radius-r(e[n],t);i<=s&&(s=i)}for(let e=0;e<n.length;++e){const i=r(n[e],t)-n[e].radius;i<=s&&(s=i)}return s}function F(t,e,s){const i=[];for(const e of t)i.push({x:e.x,y:e.y}),i.push({x:e.x+e.radius/2,y:e.y}),i.push({x:e.x-e.radius/2,y:e.y}),i.push({x:e.x,y:e.y+e.radius/2}),i.push({x:e.x,y:e.y-e.radius/2});let o=i[0],l=A(i[0],t,e);for(let n=1;n<i.length;++n){const s=A(i[n],t,e);s>=l&&(o=i[n],l=s)}const c=u.nelderMead(n=>-1*A({x:n[0],y:n[1]},t,e),[o.x,o.y],{maxIterations:500,minErrorDelta:1e-10}).x,f={x:s?0:c[0],y:c[1]};let h=!0;for(const e of t)if(r(f,e)>e.radius){h=!1;break}for(const t of e)if(r(f,t)<t.radius){h=!1;break}if(h)return f;if(1==t.length)return{x:t[0].x,y:t[0].y};const x={};return n(t,x),0===x.arcs.length?{x:0,y:-1e3,disjoint:!0}:1==x.arcs.length?{x:x.arcs[0].circle.x,y:x.arcs[0].circle.y}:e.length?F(t,[]):a(x.arcs.map(t=>t.p1))}function P(t){const e={},n=Object.keys(t);for(const t of n)e[t]=[];for(let s=0;s<n.length;s++){const i=n[s],o=t[i];for(let a=s+1;a<n.length;++a){const s=n[a],l=t[s],c=r(o,l);c+l.radius<=o.radius+1e-10?e[s].push(i):c+o.radius<=l.radius+1e-10&&e[i].push(s)}}return e}function j(t,e,n){const s={},r=P(t);for(let i=0;i<e.length;++i){const o=e[i].sets,a={},l={};for(let t=0;t<o.length;++t){a[o[t]]=!0;const e=r[o[t]];for(let t=0;t<e.length;++t)l[e[t]]=!0}const c=[],u=[];for(let e in t)e in a?c.push(t[e]):e in l||u.push(t[e]);const f=F(c,u,n);s[o]=f,f.disjoint&&e[i].size>0&&console.log("WARNING: area "+o+" not represented on screen")}return s}function S(t,e,n){const s=[];return s.push("\nM",t,e),s.push("\nm",-n,0),s.push("\na",n,n,0,1,0,2*n,0),s.push("\na",n,n,0,1,0,2*-n,0),s.join(" ")}function T(t){const e=t.split(" ");return{x:Number.parseFloat(e[1]),y:Number.parseFloat(e[2]),radius:-Number.parseFloat(e[4])}}function E(t){if(0===t.length)return[];const e={};return n(t,e),e.arcs}function C(t,e){if(0===t.length)return"M 0 0";const n=Math.pow(10,e||0),s=null!=e?t=>Math.round(t*n)/n:t=>t;if(1==t.length){const e=t[0].circle;return S(s(e.x),s(e.y),s(e.radius))}const r=["\nM",s(t[0].p2.x),s(t[0].p2.y)];for(const e of t){const t=s(e.circle.radius);r.push("\nA",t,t,0,e.large?1:0,e.sweep?1:0,s(e.p1.x),s(e.p1.y))}return r.join(" ")}function O(t,e){return C(E(t),e)}t.VennDiagram=function(t={}){let e=!1,n=600,s=350,r=15,i=1e3,o=Math.PI/2,a=!0,l=null,c=!0,u=!0,h=null,x=null,g=!1,d=null,m=!(!t||!t.symmetricalTextCentre)&&t.symmetricalTextCentre,M={},v=t&&t.colourScheme?t.colourScheme:t&&t.colorScheme?t.colorScheme:["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],w=0,I=function(t){if(t in M)return M[t];var e=M[t]=v[w];return(w+=1)>=v.length&&(w=0),e},A=f,F=p;function P(f){let p=f.datum();const y=new Set;p.forEach(t=>{0==t.size&&1==t.sets.length&&y.add(t.sets[0])}),p=p.filter(t=>!t.sets.some(t=>y.has(t)));let M={},v={};if(p.length>0){let t=A(p,{lossFunction:F,distinct:g});a&&(t=b(t,o,x)),M=z(t,n,s,r,l),v=j(M,p,m)}const w={};function P(t){return t.sets in w?w[t.sets]:1==t.sets.length?""+t.sets[0]:void 0}p.forEach(t=>{t.label&&(w[t.sets]=t.label)}),f.selectAll("svg").data([M]).enter().append("svg");const S=f.select("svg");e?S.attr("viewBox",`0 0 ${n} ${s}`):S.attr("width",n).attr("height",s);const E={};let C=!1;function N(t){return e=>O(t.sets.map(t=>{let r=E[t],i=M[t];return r||(r={x:n/2,y:s/2,radius:1}),i||(i={x:n/2,y:s/2,radius:1}),{x:r.x*(1-e)+i.x*e,y:r.y*(1-e)+i.y*e,radius:r.radius*(1-e)+i.radius*e}}),d)}S.selectAll(".venn-area path").each(function(t){const e=this.getAttribute("d");1==t.sets.length&&e&&!g&&(C=!0,E[t.sets[0]]=T(e))});const k=S.selectAll(".venn-area").data(p,t=>t.sets),q=k.enter().append("g").attr("class",t=>`venn-area venn-${1==t.sets.length?"circle":"intersection"}${t.colour||t.color?" venn-coloured":""}`).attr("data-venn-sets",t=>t.sets.join("_")),D=q.append("path"),$=q.append("text").attr("class","label").text(t=>P(t)).attr("text-anchor","middle").attr("dy",".35em").attr("x",n/2).attr("y",s/2);function L(t){return"function"==typeof t.transition?t.transition("venn").duration(i):t}u&&(D.style("fill-opacity","0").filter(t=>1==t.sets.length).style("fill",t=>t.colour?t.colour:t.color?t.color:I(t.sets)).style("fill-opacity",".25"),$.style("fill",e=>e.colour||e.color?"#FFF":t.textFill?t.textFill:1==e.sets.length?I(e.sets):"#444"));let _=f;C?(_=L(f)).selectAll("path").attrTween("d",N):_.selectAll("path").attr("d",t=>O(t.sets.map(t=>M[t])),d);const G=_.selectAll("text").filter(t=>t.sets in v).text(t=>P(t)).attr("x",t=>Math.floor(v[t.sets].x)).attr("y",t=>Math.floor(v[t.sets].y));c&&(C?"on"in G?G.on("end",R(M,P)):G.each("end",R(M,P)):G.each(R(M,P)));const V=L(k.exit()).remove();V.selectAll("path").attrTween("d",N);const B=V.selectAll("text").attr("x",n/2).attr("y",s/2);return null!==h&&($.style("font-size","0px"),G.style("font-size",h),B.style("font-size","0px")),{circles:M,textCentres:v,nodes:k,enter:q,update:_,exit:V}}return P.wrap=function(t){return arguments.length?(c=t,P):c},P.useViewBox=function(){return e=!0,P},P.width=function(t){return arguments.length?(n=t,P):n},P.height=function(t){return arguments.length?(s=t,P):s},P.padding=function(t){return arguments.length?(r=t,P):r},P.distinct=function(t){return arguments.length?(g=t,P):g},P.colours=function(t){return arguments.length?(I=t,P):I},P.colors=function(t){return arguments.length?(I=t,P):colors},P.fontSize=function(t){return arguments.length?(h=t,P):h},P.round=function(t){return arguments.length?(d=t,P):d},P.duration=function(t){return arguments.length?(i=t,P):i},P.layoutFunction=function(t){return arguments.length?(A=t,P):A},P.normalize=function(t){return arguments.length?(a=t,P):a},P.scaleToFit=function(t){return arguments.length?(l=t,P):l},P.styled=function(t){return arguments.length?(u=t,P):u},P.orientation=function(t){return arguments.length?(o=t,P):o},P.orientationOrder=function(t){return arguments.length?(x=t,P):x},P.lossFunction=function(t){return arguments.length?(F="default"===t?p:"logRatio"===t?y:t,P):F},P},t.bestInitialLayout=g,t.circleArea=s,t.circleCircleIntersection=o,t.circleFromPath=T,t.circleOverlap=i,t.circlePath=S,t.computeTextCentre=F,t.computeTextCentres=j,t.disjointCluster=M,t.distance=r,t.distanceFromIntersectArea=x,t.greedyLayout=d,t.intersectionArea=n,t.intersectionAreaPath=O,t.layout=function(t,e={}){const{lossFunction:n,layoutFunction:s=f,normalize:r=!0,orientation:i=Math.PI/2,orientationOrder:o,width:a=600,height:l=350,padding:c=15,scaleToFit:u=!1,symmetricalTextCentre:h=!1,distinct:x,round:g=2}=e;let d=s(t,{lossFunction:"default"!==n&&n?"logRatio"===n?y:n:p,distinct:x});r&&(d=b(d,i,o));const m=z(d,a,l,c,u),M=j(m,t,h),v=new Map(Object.keys(m).map(t=>[t,{set:t,x:m[t].x,y:m[t].y,radius:m[t].radius}])),w=t.map(t=>{const e=t.sets.map(t=>v.get(t)),n=E(e);return{circles:e,arcs:n,path:C(n,g),area:t,has:new Set(t.sets)}});return w.map(({circles:t,arcs:e,path:n,area:s})=>({data:s,text:M[s.sets],circles:t,arcs:e,path:n,distinctPath:n+function(t){let e="";for(const n of w)n.has.size>t.length&&t.every(t=>n.has.has(t))&&(e+=" "+n.path);return e}(s.sets)}))},t.logRatioLossFunction=y,t.lossFunction=p,t.normalizeSolution=b,t.scaleSolution=z,t.sortAreas=function(t,e){const n=P(t.selectAll("svg").datum()),s=new Set;for(const t of e.sets)for(let e in n){const r=n[e];for(let n=0;n<r.length;++n)if(r[n]==t){s.add(e);break}}function r(t){return t.every(t=>!s.has(t))}t.selectAll("g").sort((t,n)=>t.sets.length!=n.sets.length?t.sets.length-n.sets.length:t==e?r(n.sets)?-1:1:n==e?r(t.sets)?1:-1:n.size-t.size)},t.venn=f,t.wrapText=R,Object.defineProperty(t,"__esModule",{value:!0})});